wOBA_Weights <- read.csv("wOBA Weights.csv")
names(wOBA_Weights)[1] <- "yearID"

Batting$uBB <- Batting$BB - Batting$IBB
Batting$X1B <- Batting$H - Batting$X2B - Batting$X3B - Batting$HR


# Get Player Names
playerIndex <- match(Batting$playerID, People$playerID)
Batting$playerName <- paste(People[playerIndex, "nameFirst"], People[playerIndex, "nameLast"])

# wOBA Weights
wobaIndex <- match(Batting$yearID, wOBA_Weights$yearID)
Batting$wBB <- wOBA_Weights[wobaIndex, 'wBB']
Batting$wHBP <- wOBA_Weights[wobaIndex, 'wHBP']
Batting$w1B <- wOBA_Weights[wobaIndex, 'w1B']
Batting$w2B <- wOBA_Weights[wobaIndex, 'w2B']
Batting$w3B <- wOBA_Weights[wobaIndex, 'w3B']
Batting$wHR <- wOBA_Weights[wobaIndex, 'wHR']

Batting$wOBA <- (Batting$wBB * Batting$uBB + 
                   Batting$wHBP * Batting$HBP + 
                   Batting$w1B * Batting$X1B + 
                   Batting$w2B * Batting$X2B + 
                   Batting$w3B * Batting$X3B + 
                   Batting$wHR * Batting$HR) /
  (Batting$AB + Batting$BB - Batting$IBB + Batting$SF + Batting$HBP)
